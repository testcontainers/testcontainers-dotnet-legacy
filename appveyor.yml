version: 0.0.{build}
skip_tags: true
image: 
  - Ubuntu
  - Visual Studio 2017
configuration: Release
environment:
  DOTNET_CLI_TELEMETRY_OPTOUT: true
  DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true
  APPVEYOR_YML_DISABLE_PS_LINUX: true

before_build:
  - dotnet restore

build:
  project: TestContainers/TestContainers.csproj
  publish_nuget: true
  verbosity: minimal
  
test_script:
  - ps: |
      cd TestContainers.Tests
      dotnet xunit -namespace "TestContainers.Tests.Windows"
  - sh: |
      cd TestContainers.Tests
      dotnet xunit -namespace "TestContainers.Tests.Linux"

# deploy:
#   provider: NuGet
#   api_key:
#     secure: QcVgtyv0PDmNw325lb+krjV9E5QYdFdk7/cAkt03VxlXDDysoGhv6pzLfF8HqQtS
#   skip_symbols: false
#   artifact: /.*\.nupkg/
on_finish:
 - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))